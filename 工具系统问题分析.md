# å·¥å…·ç³»ç»Ÿé—®é¢˜åˆ†ææŠ¥å‘Š

## ğŸ¯ æ ¸å¿ƒé—®é¢˜

**AIçœ‹ä¸åˆ°å·¥å…·çš„æ ¹æœ¬åŸå› ï¼š** `extension/src/agent/v1/prompts/tools/index.ts` æ–‡ä»¶å¯¼å…¥äº†4ä¸ªä¸å­˜åœ¨çš„æ–‡ä»¶ï¼Œå¯¼è‡´æ•´ä¸ªæ¨¡å—åŠ è½½å¤±è´¥ï¼Œå·¥å…·ç³»ç»Ÿæ— æ³•åˆå§‹åŒ–ã€‚

### ç¼ºå¤±çš„æ–‡ä»¶
1. `fetch-webpage.ts` 
2. `get-errors.ts`
3. `context7.ts`
4. `compress-context.ts`

è¿™äº›æ–‡ä»¶è¢«å¯¼å…¥ä½†å®é™…ä¸å­˜åœ¨ï¼Œå¯¼è‡´TypeScriptç¼–è¯‘å¤±è´¥ï¼Œæ•´ä¸ªå·¥å…·æ³¨å†Œç³»ç»Ÿæ— æ³•è¿è¡Œã€‚

---

## ğŸ“š å·¥å…·æ³¨å†Œå®Œæ•´æµç¨‹ï¼ˆä»¥read_fileä¸ºä¾‹ï¼‰

### ç¬¬ä¸€æ­¥ï¼šSchemaå®šä¹‰ (`tools/schema/read_file.ts`)
```typescript
import { z } from "zod"

const schema = z.object({
    path: z.string().describe("æ–‡ä»¶è·¯å¾„")
})

export const readFileTool = {
    schema: { name: "read_file", schema },
    examples: [...]
}
```
**ä½œç”¨**ï¼šå®šä¹‰å·¥å…·å‚æ•°çš„ZodéªŒè¯è§„åˆ™

### ç¬¬äºŒæ­¥ï¼šPromptå®šä¹‰ (`prompts/tools/read-file.ts`)
```typescript
export const readFilePrompt: ToolPromptSchema = {
    name: 'read_file',
    description: 'è¯»å–æŒ‡å®šè·¯å¾„çš„æ–‡ä»¶å†…å®¹...',
    parameters: {
        path: {
            type: 'string',
            description: 'è¦è¯»å–çš„æ–‡ä»¶è·¯å¾„',
            required: true,
        },
    },
    capabilities: [
        'ä½ å¯ä»¥ä½¿ç”¨read_fileå·¥å…·è¯»å–æ–‡ä»¶å†…å®¹...'
    ],
    examples: [
        {
            description: 'è¯»å–æ–‡ä»¶',
            output: '<read_file><path>æ–‡ä»¶è·¯å¾„</path></read_file>'
        }
    ]
}
```
**ä½œç”¨**ï¼šå®šä¹‰AIçœ‹åˆ°çš„å·¥å…·æè¿°ã€å‚æ•°è¯´æ˜å’Œä½¿ç”¨ç¤ºä¾‹

### ç¬¬ä¸‰æ­¥ï¼šToolå®ç° (`tools/runners/read-file/read-file.tool.ts`)
```typescript
export class ReadFileTool extends BaseAgentTool<ReadFileToolParams> {
    async execute() {
        // å®é™…æ‰§è¡Œè¯»å–æ–‡ä»¶çš„é€»è¾‘
        const content = await extractTextFromFile(absolutePath)
        return this.toolResponse("success", content)
    }
}
```
**ä½œç”¨**ï¼šå®ç°å·¥å…·çš„å…·ä½“æ‰§è¡Œé€»è¾‘

### ç¬¬å››æ­¥ï¼šSchemaæ³¨å†Œ (`tools/schema/index.ts`)
```typescript
import { readFileTool } from "./read_file"

export const tools = [
    readFileTool,
    // ... å…¶ä»–å·¥å…·
]
```

### ç¬¬äº”æ­¥ï¼šPromptæ³¨å†Œ (`prompts/tools/index.ts`) âš ï¸ è¿™é‡Œå‡ºé—®é¢˜äº†
```typescript
import { readFilePrompt } from './read-file'

export const toolPrompts = [
    readFilePrompt,
    // ... å…¶ä»–å·¥å…·
]
```
**é—®é¢˜æ‰€åœ¨**ï¼šè¿™ä¸ªæ–‡ä»¶å¯¼å…¥äº†ä¸å­˜åœ¨çš„æ–‡ä»¶ï¼

### ç¬¬å…­æ­¥ï¼šToolå¯¼å‡º (`tools/index.ts`)
```typescript
export * from "./runners/read-file/read-file.tool"
```

---

## ğŸ”„ ç³»ç»Ÿå¦‚ä½•å°†å·¥å…·æä¾›ç»™AI

```
ç”¨æˆ·å‘èµ·ä»»åŠ¡
    â†“
buildPromptFromTemplate() è¢«è°ƒç”¨
    â†“
åˆ›å»º PromptBuilder å®ä¾‹
    â†“
builder.addTools(toolPrompts) â† éå† toolPrompts æ•°ç»„
    â†“
ä¸ºæ¯ä¸ªå·¥å…·ç”Ÿæˆæè¿°æ–‡æœ¬ï¼š
    # tool_name
    Description: ...
    Parameters:
    - param: (required) description
    Examples:
    <kodu_action>...</kodu_action>
    â†“
ç”Ÿæˆå®Œæ•´çš„ç³»ç»Ÿæç¤ºè¯ï¼ˆåŒ…å«æ‰€æœ‰å·¥å…·æè¿°ï¼‰
    â†“
å‘é€ç»™Claude API
    â†“
AIçœ‹åˆ°å¯ç”¨å·¥å…·åˆ—è¡¨
```

**å…³é”®ç‚¹**ï¼šåªæœ‰åœ¨ `toolPrompts` æ•°ç»„ä¸­çš„å·¥å…·æ‰ä¼šè¢«æä¾›ç»™AIï¼

---

## ğŸ” å‘ç°çš„é—®é¢˜

### é—®é¢˜1ï¼šå¯¼å…¥ä¸å­˜åœ¨çš„æ–‡ä»¶ï¼ˆæœ€ä¸¥é‡ï¼‰
`prompts/tools/index.ts` å°è¯•å¯¼å…¥ä»¥ä¸‹ä¸å­˜åœ¨çš„æ–‡ä»¶ï¼š
- `./fetch-webpage` âŒ
- `./get-errors` âŒ
- `./context7` âŒ
- `./compress-context` âŒ

**å½±å“**ï¼šå¯¼è‡´æ•´ä¸ªæ¨¡å—åŠ è½½å¤±è´¥ï¼Œæ‰€æœ‰å·¥å…·éƒ½æ— æ³•æ³¨å†Œ

### é—®é¢˜2ï¼šéƒ¨åˆ†å·¥å…·ç¼ºå°‘Promptå®šä¹‰
ä¸€äº›æœ‰Schemaå®šä¹‰çš„å·¥å…·ç¼ºå°‘å¯¹åº”çš„Promptå®šä¹‰ï¼š
- `web_search` - æœ‰Schemaï¼Œæ— Prompt
- `write_to_file` - æœ‰Schemaï¼Œæ— Prompt

**å½±å“**ï¼šè¿™äº›å·¥å…·è™½ç„¶æœ‰Schemaä½†AIçœ‹ä¸åˆ°ï¼Œå› ä¸ºæ²¡æœ‰åœ¨ `toolPrompts` ä¸­æ³¨å†Œ

---

## âœ… ä¿®å¤æ–¹æ¡ˆ

### å·²å®Œæˆçš„ä¿®å¤
ä» `extension/src/agent/v1/prompts/tools/index.ts` ç§»é™¤äº†æ‰€æœ‰ä¸å­˜åœ¨æ–‡ä»¶çš„å¯¼å…¥ï¼š

```typescript
// ç§»é™¤çš„å¯¼å…¥
- import { getErrorsPrompt } from './get-errors';
- import { fetchWebpagePrompt } from './fetch-webpage';
- import { context7Prompt } from './context7';
- import { compressContextPrompt } from './compress-context';

// ä» toolPrompts æ•°ç»„ç§»é™¤
- fetchWebpagePrompt,
- getErrorsPrompt,
- context7Prompt,
- compressContextPrompt,
```

### éªŒè¯ç»“æœ
âœ… æ‰€æœ‰å¯¼å…¥çš„æ–‡ä»¶ç°åœ¨éƒ½å­˜åœ¨  
âœ… TypeScriptç¼–è¯‘æ£€æŸ¥é€šè¿‡ï¼ˆæ— ç±»å‹é”™è¯¯ï¼‰  
âœ… Linteræ£€æŸ¥é€šè¿‡ï¼ˆæ— ä»£ç é£æ ¼é”™è¯¯ï¼‰  
âœ… å·¥å…·ç³»ç»Ÿåº”è¯¥èƒ½æ­£å¸¸åˆå§‹åŒ–  

---

## ğŸ“Š å½“å‰å¯ç”¨å·¥å…·åˆ—è¡¨

ä¿®å¤åï¼Œä»¥ä¸‹å·¥å…·å·²æ­£ç¡®æ³¨å†Œå¹¶å¯è¢«AIä½¿ç”¨ï¼š

### æ ¸å¿ƒäº¤äº’
- `think` - æ€è€ƒå’Œæ¨ç†
- `ask_followup_question` - è¯¢é—®ç”¨æˆ·é—®é¢˜
- `attempt_completion` - å®Œæˆä»»åŠ¡

### ç»ˆç«¯æ‰§è¡Œ
- `git_bash` - Gitå‘½ä»¤æ‰§è¡Œ
- `terminal` - ç»ˆç«¯å‘½ä»¤æ‰§è¡Œ
- `dev_server` - å¼€å‘æœåŠ¡å™¨ç®¡ç†

### æ–‡ä»¶ç³»ç»Ÿ - æµè§ˆå’Œè¯»å–
- `read_file` - è¯»å–æ–‡ä»¶
- `list_files` - åˆ—å‡ºæ–‡ä»¶
- `explore_repo_folder` - æ¢ç´¢ä»“åº“ç›®å½•
- `read_image` - è¯»å–å›¾ç‰‡

### ä»£ç æœç´¢
- `search_files` - æœç´¢æ–‡ä»¶
- `search_symbols` - æœç´¢ç¬¦å·
- `grep_search` - Grepæœç´¢
- `pattern_search` - æ¨¡å¼æœç´¢

### æ–‡ä»¶ç¼–è¾‘
- `file_editor` - æ–‡ä»¶ç¼–è¾‘å™¨
- `fast_editor` - å¿«é€Ÿç¼–è¾‘å™¨
- `replace_string` - å­—ç¬¦ä¸²æ›¿æ¢
- `multi_replace_string` - å¤šå¤„å­—ç¬¦ä¸²æ›¿æ¢
- `insert_edit` - æ’å…¥ç¼–è¾‘

### æ–‡ä»¶æ“ä½œ
- `move` - ç§»åŠ¨æ–‡ä»¶
- `remove` - åˆ é™¤æ–‡ä»¶
- `rename` - é‡å‘½åæ–‡ä»¶

### ç»ˆç«¯å·¥å…·
- `kill_bash` - ç»ˆæ­¢ç»ˆç«¯è¿›ç¨‹
- `read_progress` - è¯»å–è¿›åº¦

### ç½‘ç»œ
- `url_screenshot` - URLæˆªå›¾

### VSCodeé›†æˆ
- `vscode_api` - VSCode APIè°ƒç”¨

### Agentç®¡ç†
- `spawn_agent` - åˆ›å»ºå­Agent

### é«˜çº§åŠŸèƒ½
- `timer` - è®¡æ—¶å™¨

**æ€»è®¡ï¼š27ä¸ªå·¥å…·**

---

## ğŸ› ï¸ æ·»åŠ æ–°å·¥å…·çš„æ ‡å‡†æµç¨‹

å¦‚æœå°†æ¥è¦æ·»åŠ æ–°å·¥å…·ï¼Œè¯·æŒ‰ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š

### 1. åˆ›å»ºSchemaå®šä¹‰
æ–‡ä»¶ä½ç½®ï¼š`extension/src/agent/v1/tools/schema/{tool_name}.ts`

```typescript
import { z } from "zod"

const schema = z.object({
    // å®šä¹‰å‚æ•°
})

export const myNewTool = {
    schema: { name: "my_new_tool", schema },
    examples: [...]
}
```

### 2. åˆ›å»ºPromptå®šä¹‰
æ–‡ä»¶ä½ç½®ï¼š`extension/src/agent/v1/prompts/tools/{tool-name}.ts`

```typescript
import { ToolPromptSchema } from '../utils/utils'

export const myNewToolPrompt: ToolPromptSchema = {
    name: 'my_new_tool',
    description: 'å·¥å…·æè¿°',
    parameters: { /* å‚æ•°å®šä¹‰ */ },
    capabilities: [ /* èƒ½åŠ›æè¿° */ ],
    examples: [ /* ä½¿ç”¨ç¤ºä¾‹ */ ]
}
```

### 3. åˆ›å»ºToolå®ç°
æ–‡ä»¶ä½ç½®ï¼š`extension/src/agent/v1/tools/runners/{tool-name}.tool.ts`

```typescript
import { BaseAgentTool } from "../base-agent.tool"

export class MyNewTool extends BaseAgentTool<MyNewToolParams> {
    async execute() {
        // å®ç°é€»è¾‘
    }
}
```

### 4. æ³¨å†ŒSchema
åœ¨ `extension/src/agent/v1/tools/schema/index.ts` ä¸­ï¼š

```typescript
import { myNewTool } from "./my_new_tool"

export const tools = [
    // ... ç°æœ‰å·¥å…·
    myNewTool,  // æ·»åŠ æ–°å·¥å…·
] as const
```

### 5. æ³¨å†ŒPrompt
åœ¨ `extension/src/agent/v1/prompts/tools/index.ts` ä¸­ï¼š

```typescript
import { myNewToolPrompt } from './my-new-tool'

export const toolPrompts = [
    // ... ç°æœ‰å·¥å…·
    myNewToolPrompt,  // æ·»åŠ æ–°å·¥å…·
]
```

### 6. å¯¼å‡ºToolç±»
åœ¨ `extension/src/agent/v1/tools/index.ts` ä¸­ï¼š

```typescript
export * from "./runners/my-new-tool.tool"
```

### 7. éªŒè¯
- è¿è¡Œ `pnpm run check-types` æ£€æŸ¥ç±»å‹é”™è¯¯
- è¿è¡Œ `pnpm run lint` æ£€æŸ¥ä»£ç é£æ ¼
- è¿è¡Œ `pnpm run compile` å®Œæ•´ç¼–è¯‘

---

## ğŸ“ å…³é”®è¦ç‚¹

1. **ä¸‰ä¸ªå¿…éœ€ç»„ä»¶**ï¼šSchemaå®šä¹‰ + Promptå®šä¹‰ + Toolå®ç°
2. **ä¸¤ä¸ªæ³¨å†Œç‚¹**ï¼š`schema/index.ts` + `prompts/tools/index.ts`
3. **ä¸€ä¸ªå¯¼å‡º**ï¼š`tools/index.ts`
4. **å¯¼å…¥æ–‡ä»¶å¿…é¡»å­˜åœ¨**ï¼šä»»ä½•å¯¼å…¥éƒ½å¿…é¡»ç¡®ä¿æ–‡ä»¶å®é™…å­˜åœ¨
5. **åªæœ‰åœ¨toolPromptsæ•°ç»„ä¸­çš„å·¥å…·AIæ‰èƒ½çœ‹åˆ°**ï¼šè¿™æ˜¯æœ€å…³é”®çš„ä¸€ç‚¹

---

## ğŸ“ æ€»ç»“

**é—®é¢˜**ï¼šå¯¼å…¥ä¸å­˜åœ¨çš„æ–‡ä»¶å¯¼è‡´å·¥å…·ç³»ç»ŸåŠ è½½å¤±è´¥  
**æ ¹å› **ï¼šå¯èƒ½æ˜¯é‡æ„æˆ–æ–‡ä»¶åˆ é™¤æ—¶æ²¡æœ‰æ¸…ç†å¯¼å…¥  
**ä¿®å¤**ï¼šç§»é™¤æ‰€æœ‰ä¸å­˜åœ¨æ–‡ä»¶çš„å¯¼å…¥å’Œå¼•ç”¨  
**çŠ¶æ€**ï¼šâœ… å·²ä¿®å¤å¹¶éªŒè¯  
**å½±å“**ï¼šç³»ç»Ÿç°åœ¨åº”è¯¥èƒ½æ­£å¸¸åŠ è½½æ‰€æœ‰27ä¸ªå·²æ³¨å†Œå·¥å…·

AIå°†èƒ½å¤Ÿçœ‹åˆ°å¹¶ä½¿ç”¨æ‰€æœ‰æ­£ç¡®æ³¨å†Œçš„å·¥å…·æ¥å¸®åŠ©ç”¨æˆ·å®Œæˆå¼€å‘ä»»åŠ¡ã€‚



