# Terminal å®‰å…¨ç­–ç•¥åˆ†ææŠ¥å‘Š

## ğŸ“‹ æ¦‚è¿°

Terminalå·¥å…·ä½¿ç”¨ä¸‰å±‚å®‰å…¨ç­–ç•¥æ¥ä¿æŠ¤ç”¨æˆ·ç³»ç»Ÿï¼š
1. **Blockï¼ˆé˜»æ­¢ï¼‰** - ç›´æ¥æ‹’ç»æ‰§è¡Œ
2. **RiskKeywordsï¼ˆé£é™©å…³é”®è¯ï¼‰** - æç¤ºç”¨æˆ·äºŒæ¬¡ç¡®è®¤
3. **Allowï¼ˆå…è®¸ï¼‰** - æ˜ç¡®å…è®¸çš„å‘½ä»¤æ¨¡å¼

## ğŸš« è¢«å®Œå…¨é˜»æ­¢çš„å‘½ä»¤ï¼ˆBlock Listï¼‰

### æ‰€æœ‰å¹³å°ï¼ˆCommonï¼‰
```
rm -rf /*        # åˆ é™¤æ ¹ç›®å½•æ‰€æœ‰æ–‡ä»¶
rm -rf ~         # åˆ é™¤ç”¨æˆ·ä¸»ç›®å½•
```

### Windows å¹³å°é¢å¤–é˜»æ­¢
```
rm -rf /                    # åˆ é™¤æ ¹ç›®å½•
rm -rf /*                   # åˆ é™¤æ ¹ç›®å½•æ‰€æœ‰æ–‡ä»¶ï¼ˆé‡å¤ï¼‰
rm -rf ~                    # åˆ é™¤ç”¨æˆ·ä¸»ç›®å½•ï¼ˆé‡å¤ï¼‰
:(){:|:&};:                 # Forkç‚¸å¼¹
dd if=/dev/zero             # ç£ç›˜æ“¦é™¤
mkfs                        # æ ¼å¼åŒ–æ–‡ä»¶ç³»ç»Ÿ
```

### macOS/Linux å¹³å°é¢å¤–é˜»æ­¢
```
rm -rf /                    # åˆ é™¤æ ¹ç›®å½•
rm -rf /*                   # åˆ é™¤æ ¹ç›®å½•æ‰€æœ‰æ–‡ä»¶
rm -rf ~                    # åˆ é™¤ç”¨æˆ·ä¸»ç›®å½•
:(){:|:&};:                 # Forkç‚¸å¼¹
dd if=/dev/zero             # ç£ç›˜æ“¦é™¤
mkfs                        # æ ¼å¼åŒ–æ–‡ä»¶ç³»ç»Ÿ
```

## âš ï¸ éœ€è¦äºŒæ¬¡ç¡®è®¤çš„å‘½ä»¤ï¼ˆRisk Keywordsï¼‰

### æ‰€æœ‰å¹³å°ï¼ˆCommonï¼‰
```
sudo [å‘½ä»¤]      # è¶…çº§ç”¨æˆ·æƒé™å‘½ä»¤
```

### æ‰€æœ‰å¹³å°ï¼ˆPlatform Specificï¼‰
```
/dev/            # æ¶‰åŠè®¾å¤‡æ–‡ä»¶
> /dev/          # é‡å®šå‘åˆ°è®¾å¤‡æ–‡ä»¶
format           # æ ¼å¼åŒ–å‘½ä»¤
```

## âœ… æ˜ç¡®å…è®¸çš„å‘½ä»¤ï¼ˆAllow Listï¼‰

### Windows å¹³å°ï¼ˆæ›´å®½æ¾ï¼‰
```
^npm             # npm åŒ…ç®¡ç†
^yarn            # yarn åŒ…ç®¡ç†
^pnpm            # pnpm åŒ…ç®¡ç†
^git             # Git ç‰ˆæœ¬æ§åˆ¶
^grep            # æ–‡æœ¬æœç´¢
^find            # æ–‡ä»¶æŸ¥æ‰¾
^sed             # æµç¼–è¾‘å™¨
^awk             # æ–‡æœ¬å¤„ç†
^curl            # ç½‘ç»œè¯·æ±‚
^wget            # æ–‡ä»¶ä¸‹è½½
^ls              # åˆ—å‡ºæ–‡ä»¶
^cat             # æŸ¥çœ‹æ–‡ä»¶
^echo            # è¾“å‡ºæ–‡æœ¬
^mkdir           # åˆ›å»ºç›®å½•
^touch           # åˆ›å»ºæ–‡ä»¶
^mv              # ç§»åŠ¨æ–‡ä»¶
^cp              # å¤åˆ¶æ–‡ä»¶
^node            # Node.js
^python          # Python
^java            # Java
^cargo           # Rust åŒ…ç®¡ç†
^go              # Go è¯­è¨€
^dotnet          # .NET
```

### macOS/Linux å¹³å°ï¼ˆè¾ƒä¸¥æ ¼ï¼‰
```
^npm             # npm åŒ…ç®¡ç†
^yarn            # yarn åŒ…ç®¡ç†
^pnpm            # pnpm åŒ…ç®¡ç†
^git             # Git ç‰ˆæœ¬æ§åˆ¶
```

## ğŸ¤– å¯¹ AI å·¥ä½œçš„å½±å“åˆ†æ

### âŒ å¯èƒ½è¢«é˜»æ­¢çš„å¸¸è§ AI æ“ä½œ

1. **ä½¿ç”¨ rm å‘½ä»¤åˆ é™¤æ–‡ä»¶**
   - âŒ `rm -rf /path/to/folder` - å¦‚æœè·¯å¾„æ˜¯ `/`ã€`/*` æˆ– `~` ä¼šè¢«é˜»æ­¢
   - âœ… `rm -rf ./local/folder` - ç›¸å¯¹è·¯å¾„é€šå¸¸å…è®¸
   - âœ… `rm file.txt` - åˆ é™¤å•ä¸ªæ–‡ä»¶å…è®¸

2. **ä½¿ç”¨ sudo æƒé™**
   - âš ï¸ `sudo apt install package` - éœ€è¦ç”¨æˆ·äºŒæ¬¡ç¡®è®¤
   - âš ï¸ `sudo npm install -g` - éœ€è¦ç”¨æˆ·äºŒæ¬¡ç¡®è®¤

3. **macOS/Linux ä¸Šçš„æ–‡ä»¶æ“ä½œ**
   - âŒ macOS/Linux çš„ Allow List å¾ˆä¸¥æ ¼ï¼Œåªå…è®¸ npmã€yarnã€pnpmã€git
   - âŒ `ls`ã€`cat`ã€`mkdir`ã€`cp`ã€`mv` ç­‰åŸºæœ¬å‘½ä»¤åœ¨ macOS/Linux ä¸Šä¸åœ¨ç™½åå•ä¸­
   - âš ï¸ **è¿™æ˜¯ä¸»è¦é—®é¢˜ï¼** åœ¨é Windows å¹³å°ï¼ŒAI æ— æ³•ä½¿ç”¨å¤§å¤šæ•°æ–‡ä»¶æ“ä½œå‘½ä»¤

### ğŸ” ä¸¥é‡é—®é¢˜ï¼šmacOS/Linux çš„ Allow List è¿‡äºä¸¥æ ¼

**å½“å‰é…ç½®ï¼š**
```json
"darwin": {
  "allow": [
    "^npm ",
    "^yarn ",
    "^pnpm ",
    "^git "
  ]
}
```

**é—®é¢˜ï¼š**
- âŒ æ— æ³•ä½¿ç”¨ `ls` åˆ—å‡ºæ–‡ä»¶
- âŒ æ— æ³•ä½¿ç”¨ `cat` æŸ¥çœ‹æ–‡ä»¶
- âŒ æ— æ³•ä½¿ç”¨ `mkdir` åˆ›å»ºç›®å½•
- âŒ æ— æ³•ä½¿ç”¨ `cp`/`mv` å¤åˆ¶ç§»åŠ¨æ–‡ä»¶
- âŒ æ— æ³•ä½¿ç”¨ `grep`/`find` æœç´¢
- âŒ æ— æ³•ä½¿ç”¨ `curl`/`wget` ä¸‹è½½
- âŒ æ— æ³•ä½¿ç”¨ `node`/`python` è¿è¡Œè„šæœ¬

### ğŸ¯ AI çš„å…·ä½“æŠ±æ€¨å¯èƒ½æ˜¯

AI åœ¨ **macOS** æˆ– **Linux** ç³»ç»Ÿä¸Šå°è¯•ï¼š
- åˆ—å‡ºæ–‡ä»¶ï¼š`ls -la` âŒ ä¸åœ¨ç™½åå•
- æŸ¥çœ‹æ–‡ä»¶ï¼š`cat file.txt` âŒ ä¸åœ¨ç™½åå•
- åˆ›å»ºç›®å½•ï¼š`mkdir new_dir` âŒ ä¸åœ¨ç™½åå•
- å¤åˆ¶æ–‡ä»¶ï¼š`cp file1 file2` âŒ ä¸åœ¨ç™½åå•
- è¿è¡Œè„šæœ¬ï¼š`node script.js` âŒ ä¸åœ¨ç™½åå•
- è¿è¡Œ Pythonï¼š`python script.py` âŒ ä¸åœ¨ç™½åå•

## ğŸ’¡ ç­–ç•¥è¯„ä¼°è§„åˆ™

æ ¹æ® `sandbox-engine.ts` çš„é€»è¾‘ï¼š

```
ä¼˜å…ˆçº§ 1: Block Listï¼ˆæœ€é«˜ï¼‰
  â†“ å¦‚æœå‘½ä¸­ â†’ ç›´æ¥é˜»æ­¢
  
ä¼˜å…ˆçº§ 2: Risk Keywords
  â†“ å¦‚æœå‘½ä¸­ â†’ è­¦å‘Šå¹¶éœ€è¦ç”¨æˆ·ç¡®è®¤
  
ä¼˜å…ˆçº§ 3: Allow Listï¼ˆå’¨è¯¢æ€§ï¼‰
  â†“ å¦‚æœ Allow List å­˜åœ¨ï¼š
      - å‘½ä¸­ â†’ å…è®¸
      - æœªå‘½ä¸­ â†’ é»˜è®¤å…è®¸ï¼ˆä½†ä¼šæç¤ºï¼‰
  â†“ å¦‚æœ Allow List ä¸å­˜åœ¨ï¼š
      - é»˜è®¤å…è®¸æ‰€æœ‰
```

**å…³é”®ä»£ç ï¼š**
```typescript
// Allow check (advisory)
if (allowList.length > 0) {
    for (const pattern of allowList) {
        if (re.test(clean)) {
            return { decision: "allow", reasons }
        }
    }
    // Not matching allow does not block by default
    reasons.push("no allow rule matched; defaulting to allow")
    return { decision: "allow", reasons }
}
```

## ğŸ”§ å»ºè®®çš„ä¿®å¤æ–¹æ¡ˆ

### æ–¹æ¡ˆ 1: ç»Ÿä¸€ Allow Listï¼ˆæ¨èï¼‰

å°† macOS/Linux çš„ Allow List æ”¹ä¸ºä¸ Windows ä¸€è‡´ï¼š

```json
"darwin": {
  "preferredShell": "default",
  "allow": [
    "^npm ", "^yarn ", "^pnpm ", "^git ",
    "^grep ", "^find ", "^sed ", "^awk ",
    "^curl ", "^wget ",
    "^ls ", "^cat ", "^echo ",
    "^mkdir ", "^touch ", "^mv ", "^cp ",
    "^node ", "^python ", "^java ",
    "^cargo ", "^go ", "^dotnet ",
    "^cd ", "^pwd ", "^which ", "^type "
  ]
}

"linux": {
  "preferredShell": "default",
  "allow": [
    "^npm ", "^yarn ", "^pnpm ", "^git ",
    "^grep ", "^find ", "^sed ", "^awk ",
    "^curl ", "^wget ",
    "^ls ", "^cat ", "^echo ",
    "^mkdir ", "^touch ", "^mv ", "^cp ",
    "^node ", "^python ", "^java ",
    "^cargo ", "^go ", "^dotnet ",
    "^cd ", "^pwd ", "^which ", "^type "
  ]
}
```

### æ–¹æ¡ˆ 2: ç§»é™¤ Allow Listï¼ˆæ›´çµæ´»ï¼‰

ç”±äºä»£ç é€»è¾‘æ˜¯"æœªå‘½ä¸­ä¹Ÿé»˜è®¤å…è®¸"ï¼Œå¯ä»¥è€ƒè™‘ï¼š
- ä¿ç•™ Block Listï¼ˆç¡¬æ€§é˜»æ­¢å±é™©å‘½ä»¤ï¼‰
- ä¿ç•™ Risk Keywordsï¼ˆæç¤ºç¡®è®¤ï¼‰
- **ç§»é™¤ Allow List**ï¼ˆè®©æ‰€æœ‰éå±é™©å‘½ä»¤éƒ½èƒ½é€šè¿‡ï¼‰

### æ–¹æ¡ˆ 3: æ·»åŠ æ›´å¤šåŸºç¡€å‘½ä»¤

è‡³å°‘æ·»åŠ æœ€åŸºæœ¬çš„æ–‡ä»¶æ“ä½œå‘½ä»¤ï¼š

```json
"allow": [
  "^npm ", "^yarn ", "^pnpm ", "^git ",
  "^ls ", "^cat ", "^mkdir ", "^cd ", "^pwd "
]
```

## ğŸ“Š ç»Ÿè®¡æ•°æ®

### Windows å¹³å°
- âœ… Allow List: 29 ä¸ªå‘½ä»¤æ¨¡å¼
- âŒ Block List: 6 ä¸ªå±é™©æ¨¡å¼
- âš ï¸ Risk Keywords: 3 ä¸ª

### macOS/Linux å¹³å°
- âœ… Allow List: **ä»… 4 ä¸ªå‘½ä»¤æ¨¡å¼** âš ï¸ å¤ªå°‘ï¼
- âŒ Block List: 6 ä¸ªå±é™©æ¨¡å¼
- âš ï¸ Risk Keywords: 3 ä¸ª

### å·®å¼‚
Windows çš„ Allow List æ¯” macOS/Linux å¤šäº† **25 ä¸ªå‘½ä»¤**ï¼

## ğŸ¯ ç»“è®º

**AI æŠ±æ€¨çš„åŸå› ï¼š**

åœ¨ **macOS** æˆ– **Linux** ç³»ç»Ÿä¸Šï¼ŒTerminal çš„ Allow List é…ç½®è¿‡äºä¸¥æ ¼ï¼Œåªå…è®¸ 4 ä¸ªå‘½ä»¤ï¼ˆnpmã€yarnã€pnpmã€gitï¼‰ï¼Œå¯¼è‡´ AI æ— æ³•æ‰§è¡Œå¤§å¤šæ•°åŸºæœ¬çš„æ–‡ä»¶æ“ä½œå’Œç³»ç»Ÿå‘½ä»¤ã€‚

**è™½ç„¶ä»£ç é€»è¾‘ä¸Š"æœªå‘½ä¸­ä¹Ÿé»˜è®¤å…è®¸"ï¼Œä½†è¿™å¯èƒ½ï¼š**
1. æ¯æ¬¡éƒ½è§¦å‘è­¦å‘Šæç¤ºï¼Œå½±å“ç”¨æˆ·ä½“éªŒ
2. è®© AI è®¤ä¸ºå‘½ä»¤ä¼šè¢«é˜»æ­¢ï¼Œä»è€Œé¿å…ä½¿ç”¨
3. åœ¨æŸäº›é…ç½®ä¸‹å®é™…è¢«é˜»æ­¢

**å»ºè®®ï¼šç«‹å³å°† macOS/Linux çš„ Allow List æ”¹ä¸ºä¸ Windows ä¸€è‡´ã€‚**

